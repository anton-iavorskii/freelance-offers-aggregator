{"ast":null,"code":"var _jsxFileName = \"/home/anton/\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u044B/GitHub/ElbrusHP/freelance_offers/freelance-offers-aggregator/frontend/src/components/Feed.jsx\";\nimport React from 'react';\nimport Loader from 'react-loader-spinner';\nimport 'react-loader-spinner/dist/loader/css/react-spinner-loader.css';\nimport CardShort from './CardShort';\nimport CardNormal from './CardNormal';\nimport CardExpanded from './CardExpanded';\nimport Pagination from './Pagination';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { setNumberOfOffersAC } from '../store/slice';\n\nfunction Feed() {\n  const dispatch = useDispatch();\n  const {\n    componentsSize,\n    filterSearch,\n    filterFavourites,\n    filterBudget,\n    sortOption,\n    currentPage,\n    postsPerPage\n  } = useSelector(state => state.slice.view);\n  const isAuth = useSelector(state => state.slice.user.isAuth);\n  const offersAll = useSelector(state => state.slice.offers);\n  let offers = offersAll.slice(); // filtering by favourites only\n\n  if (isAuth && filterFavourites) offers = offers.filter(offer => offer.isFavourite === true); // filtering by search\n\n  offers = offers.filter(offer => offer.title.toLowerCase().includes(filterSearch.toLowerCase()) || offer.description.toLowerCase().includes(filterSearch.toLowerCase())); // filtering by budget\n\n  if (filterBudget) offers = offers.filter(offer => offer.hasProjectBudget || offer.hasHourlyRate); // filtering by tags\n  // if (filterTags.length > 0)\n  //   offers = offers.filter(offer => offer.tags.some(tag => filterTags.includes(tag)))\n  // sorting by all criterias\n\n  if (sortOption === 'hasProjectBudget') {\n    offers = offers.filter(offer => offer.hasProjectBudget === true).sort((a, b) => Number(b.budgetAbsolute) - Number(a.budgetAbsolute)).concat(offers.filter(offer => offer.hasProjectBudget === false));\n  } else if (sortOption === 'hasHourlyRate') {\n    offers = offers.filter(offer => offer.hasHourlyRate === true).sort((a, b) => Number(b.budgetAbsolute) - Number(a.budgetAbsolute)).concat(offers.filter(offer => offer.hasHourlyRate === false));\n  } else if (sortOption === 'publishedAtTS') {\n    offers = offers.sort((a, b) => Number(b.publishedAtTS) - Number(a.publishedAtTS));\n  } // slice by pagination \n\n\n  const indexOfLastOffer = currentPage * postsPerPage;\n  const indexOfFirstOffer = indexOfLastOffer - postsPerPage;\n  const paginatedOffers = offers.slice(indexOfFirstOffer, indexOfLastOffer);\n  dispatch(setNumberOfOffersAC(offers.length));\n  if (paginatedOffers) return /*#__PURE__*/React.createElement(React.Fragment, null, paginatedOffers.length > 0 ? /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 13\n    }\n  }, paginatedOffers.map(offer => {\n    if (offer.hasExpandedSize === true) return /*#__PURE__*/React.createElement(CardExpanded, {\n      key: offer._id,\n      offer: offer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 28\n      }\n    });else if (componentsSize === 1) return /*#__PURE__*/React.createElement(CardShort, {\n      key: offer._id,\n      offer: offer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 28\n      }\n    });else return /*#__PURE__*/React.createElement(CardNormal, {\n      key: offer._id,\n      offer: offer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 28\n      }\n    });\n  }), /*#__PURE__*/React.createElement(Pagination, {\n    totalPosts: offers.length,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 15\n    }\n  })) : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"spinner\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Loader, {\n    type: \"ThreeDots\",\n    color: \"#88afdd\",\n    height: 70,\n    width: 70,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 15\n    }\n  })));else return null;\n}\n\nexport default Feed;","map":{"version":3,"sources":["/home/anton/Документы/GitHub/ElbrusHP/freelance_offers/freelance-offers-aggregator/frontend/src/components/Feed.jsx"],"names":["React","Loader","CardShort","CardNormal","CardExpanded","Pagination","useSelector","useDispatch","setNumberOfOffersAC","Feed","dispatch","componentsSize","filterSearch","filterFavourites","filterBudget","sortOption","currentPage","postsPerPage","state","slice","view","isAuth","user","offersAll","offers","filter","offer","isFavourite","title","toLowerCase","includes","description","hasProjectBudget","hasHourlyRate","sort","a","b","Number","budgetAbsolute","concat","publishedAtTS","indexOfLastOffer","indexOfFirstOffer","paginatedOffers","length","map","hasExpandedSize","_id"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Loader from 'react-loader-spinner';\nimport 'react-loader-spinner/dist/loader/css/react-spinner-loader.css';\nimport CardShort from './CardShort';\nimport CardNormal from './CardNormal';\nimport CardExpanded from './CardExpanded';\nimport Pagination from './Pagination'\nimport { useSelector, useDispatch } from 'react-redux';\nimport { setNumberOfOffersAC } from '../store/slice'\n\nfunction Feed() {\n  const dispatch = useDispatch()\n  const {\n    componentsSize,\n    filterSearch,\n    filterFavourites,\n    filterBudget,\n    sortOption,\n    currentPage,\n    postsPerPage\n  } = useSelector(state => state.slice.view)\n  const isAuth = useSelector((state) => state.slice.user.isAuth)\n  const offersAll = useSelector((state) => state.slice.offers)\n\n  let offers = offersAll.slice()\n\n  // filtering by favourites only\n  if (isAuth && filterFavourites)\n    offers = offers.filter(offer => offer.isFavourite === true)\n\n  // filtering by search\n  offers = offers.filter(offer =>\n    offer.title.toLowerCase().includes(filterSearch.toLowerCase()) || offer.description.toLowerCase().includes(filterSearch.toLowerCase()))\n\n  // filtering by budget\n  if (filterBudget)\n    offers = offers.filter(offer => (offer.hasProjectBudget) || (offer.hasHourlyRate))\n\n  // filtering by tags\n  // if (filterTags.length > 0)\n  //   offers = offers.filter(offer => offer.tags.some(tag => filterTags.includes(tag)))\n\n  // sorting by all criterias\n  if (sortOption === 'hasProjectBudget') {\n    offers = offers\n      .filter(offer => offer.hasProjectBudget === true)\n      .sort((a, b) => Number(b.budgetAbsolute) - Number(a.budgetAbsolute))\n      .concat(offers.filter(offer => offer.hasProjectBudget === false))\n  }\n  else if (sortOption === 'hasHourlyRate') {\n    offers = offers\n      .filter(offer => offer.hasHourlyRate === true)\n      .sort((a, b) => Number(b.budgetAbsolute) - Number(a.budgetAbsolute))\n      .concat(offers.filter(offer => offer.hasHourlyRate === false))\n  }\n  else if (sortOption === 'publishedAtTS') {\n    offers = offers.sort((a, b) => Number(b.publishedAtTS) - Number(a.publishedAtTS))\n  }\n\n  // slice by pagination \n  const indexOfLastOffer = currentPage * postsPerPage\n  const indexOfFirstOffer = indexOfLastOffer - postsPerPage\n  const paginatedOffers = offers.slice(indexOfFirstOffer, indexOfLastOffer)\n\n  dispatch(setNumberOfOffersAC(offers.length))\n\n  if (paginatedOffers)\n    return (\n      <>\n        {\n          paginatedOffers.length > 0 ?\n            <div>\n              {\n                paginatedOffers.map(offer => {\n                  if (offer.hasExpandedSize === true)\n                    return <CardExpanded key={offer._id} offer={offer} />\n                  else if (componentsSize === 1)\n                    return <CardShort key={offer._id} offer={offer} />\n                  else\n                    return <CardNormal key={offer._id} offer={offer} />\n                })\n              }\n              <Pagination totalPosts={offers.length} />\n            </div>\n\n            : <div className=\"spinner\">\n              <Loader\n                type=\"ThreeDots\"\n                color=\"#88afdd\"\n                height={70}\n                width={70}\n              />\n            </div>\n        }\n      </>\n    )\n  else return null\n}\n\nexport default Feed;\n"]},"metadata":{},"sourceType":"module"}